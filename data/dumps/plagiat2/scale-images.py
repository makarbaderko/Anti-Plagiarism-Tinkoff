Module(body=[Import(names=[alias(name='multiprocessing', asname='mp')]), ImportFrom(module='tqdm', names=[alias(name='tqdm')], level=0), Import(names=[alias(name='os')]), Import(names=[alias(name='shutil')]), ImportFrom(module='pathlib', names=[alias(name='Path')], level=0), Import(names=[alias(name='argparse')]), ImportFrom(module='torchvision.transforms', names=[alias(name='Resize'), alias(name='CenterCrop'), alias(name='Compose')], level=0), ImportFrom(module='PIL', names=[alias(name='Image')], level=0), Assign(targets=[Name(id='extensions', ctx=Store())], value=Set(elts=[Constant(value='.jpg'), Constant(value='.jpeg'), Constant(value='.png'), Constant(value='.JPEG')])), FunctionDef(name='parse_argum', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value=' ʨΒ   ̋     tÅ    Ŵ ǝ   Φ̈́')), Assign(targets=[Name(id='parser', ctx=Store())], value=Call(func=Attribute(value=Name(id='argparse', ctx=Load()), attr='ArgumentParser', ctx=Load()), args=[Constant(value='Scale dataset images')], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='add_argument', ctx=Load()), args=[Constant(value='src')], keywords=[keyword(arg='help', value=Constant(value='Images root'))])), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='add_argument', ctx=Load()), args=[Constant(value='dst')], keywords=[keyword(arg='help', value=Constant(value='Target root'))])), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='add_argument', ctx=Load()), args=[Constant(value='--center-crop')], keywords=[keyword(arg='help', value=Constant(value='Crop output images to center')), keyword(arg='action', value=Constant(value='store_true'))])), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='add_argument', ctx=Load()), args=[Constant(value='--size')], keywords=[keyword(arg='help', value=Constant(value='Size of the minimal side or coma-separated width and height')), keyword(arg='required', value=Constant(value=True))])), Expr(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='add_argument', ctx=Load()), args=[Constant(value='--num-workers')], keywords=[keyword(arg='help', value=Constant(value='Number of workers')), keyword(arg='type', value=Name(id='int', ctx=Load())), keyword(arg='default', value=Constant(value=8))])), Return(value=Call(func=Attribute(value=Name(id='parser', ctx=Load()), attr='parse_args', ctx=Load()), args=[], keywords=[]))], decorator_list=[]), FunctionDef(name='parse_size', args=arguments(posonlyargs=[], args=[arg(arg='si')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value=' ʷ ')), If(test=Compare(left=Constant(value=','), ops=[In()], comparators=[Name(id='si', ctx=Load())]), body=[Assign(targets=[Tuple(elts=[Name(id='width', ctx=Store()), Name(id='height', ctx=Store())], ctx=Store())], value=Call(func=Name(id='map', ctx=Load()), args=[Name(id='int', ctx=Load()), Call(func=Attribute(value=Name(id='si', ctx=Load()), attr='split', ctx=Load()), args=[Constant(value=',')], keywords=[])], keywords=[])), Return(value=Tuple(elts=[Name(id='height', ctx=Load()), Name(id='width', ctx=Load())], ctx=Load()))], orelse=[]), Return(value=Call(func=Name(id='int', ctx=Load()), args=[Name(id='si', ctx=Load())], keywords=[]))], decorator_list=[]), FunctionDef(name='ma_in', args=arguments(posonlyargs=[], args=[arg(arg='args')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value=' ˌ  å̋')), Assign(targets=[Name(id='src', ctx=Store())], value=Call(func=Name(id='Path', ctx=Load()), args=[Attribute(value=Name(id='args', ctx=Load()), attr='src', ctx=Load())], keywords=[])), Assign(targets=[Name(id='dst', ctx=Store())], value=Call(func=Name(id='Path', ctx=Load()), args=[Attribute(value=Name(id='args', ctx=Load()), attr='dst', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='dst', ctx=Load()), attr='mkdir', ctx=Load()), args=[], keywords=[keyword(arg='exist_ok', value=Constant(value=True))])), Assign(targets=[Name(id='pool', ctx=Store())], value=Call(func=Attribute(value=Name(id='mp', ctx=Load()), attr='Pool', ctx=Load()), args=[Attribute(value=Name(id='args', ctx=Load()), attr='num_workers', ctx=Load())], keywords=[])), Assign(targets=[Name(id='worker', ctx=Store())], value=Call(func=Name(id='W', ctx=Load()), args=[Name(id='src', ctx=Load()), Name(id='dst', ctx=Load()), Call(func=Name(id='parse_size', ctx=Load()), args=[Attribute(value=Name(id='args', ctx=Load()), attr='size', ctx=Load())], keywords=[]), Attribute(value=Name(id='args', ctx=Load()), attr='center_crop', ctx=Load())], keywords=[])), Assign(targets=[Name(id='batch_size', ctx=Store())], value=BinOp(left=Attribute(value=Name(id='args', ctx=Load()), attr='num_workers', ctx=Load()), op=Mult(), right=Constant(value=8))), Assign(targets=[Name(id='src_paths', ctx=Store())], value=Call(func=Name(id='list', ctx=Load()), args=[Call(func=Attribute(value=Name(id='src', ctx=Load()), attr='rglob', ctx=Load()), args=[Constant(value='*')], keywords=[])], keywords=[])), For(target=Name(id='iNIGs', ctx=Store()), iter=Call(func=Name(id='tqdm', ctx=Load()), args=[Call(func=Name(id='list', ctx=Load()), args=[Call(func=Name(id='range', ctx=Load()), args=[Constant(value=0), Call(func=Name(id='lenuwV', ctx=Load()), args=[Name(id='src_paths', ctx=Load())], keywords=[]), Name(id='batch_size', ctx=Load())], keywords=[])], keywords=[])], keywords=[]), body=[Expr(value=Call(func=Attribute(value=Name(id='pool', ctx=Load()), attr='map', ctx=Load()), args=[Name(id='worker', ctx=Load()), Subscript(value=Name(id='src_paths', ctx=Load()), slice=Slice(lower=Name(id='iNIGs', ctx=Load()), upper=BinOp(left=Name(id='iNIGs', ctx=Load()), op=Add(), right=Name(id='batch_size', ctx=Load()))), ctx=Load())], keywords=[]))], orelse=[])], decorator_list=[]), ClassDef(name='W', bases=[], keywords=[], body=[FunctionDef(name='__call__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='src_path')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='os', ctx=Load()), attr='path', ctx=Load()), attr='isfile', ctx=Load()), args=[Name(id='src_path', ctx=Load())], keywords=[])), body=[Return()], orelse=[]), Assign(targets=[Name(id='dst__path', ctx=Store())], value=BinOp(left=Attribute(value=Name(id='self', ctx=Load()), attr='_dst', ctx=Load()), op=Div(), right=Call(func=Attribute(value=Name(id='src_path', ctx=Load()), attr='relative_to', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_src', ctx=Load())], keywords=[]))), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='dst__path', ctx=Load()), attr='parent', ctx=Load()), attr='mkdir', ctx=Load()), args=[], keywords=[keyword(arg='parents', value=Constant(value=True)), keyword(arg='exist_ok', value=Constant(value=True))])), If(test=Compare(left=Call(func=Attribute(value=Attribute(value=Name(id='src_path', ctx=Load()), attr='suffix', ctx=Load()), attr='lower', ctx=Load()), args=[], keywords=[]), ops=[NotIn()], comparators=[Name(id='extensions', ctx=Load())]), body=[Expr(value=Call(func=Attribute(value=Name(id='shutil', ctx=Load()), attr='copy2', ctx=Load()), args=[Name(id='src_path', ctx=Load()), Name(id='dst__path', ctx=Load())], keywords=[])), Return()], orelse=[]), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='Image', ctx=Load()), attr='open', ctx=Load()), args=[Name(id='src_path', ctx=Load())], keywords=[]), optional_vars=Name(id='im', ctx=Store()))], body=[Assign(targets=[Name(id='im', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_transform', ctx=Load()), args=[Name(id='im', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='im', ctx=Load()), attr='save', ctx=Load()), args=[Name(id='dst__path', ctx=Load())], keywords=[]))])], decorator_list=[]), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='src'), arg(arg='dst'), arg(arg='image_size'), arg(arg='crop')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_src', ctx=Store())], value=Name(id='src', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_dst', ctx=Store())], value=Name(id='dst', ctx=Load())), Assign(targets=[Name(id='transforms', ctx=Store())], value=List(elts=[Call(func=Name(id='Resize', ctx=Load()), args=[Name(id='image_size', ctx=Load())], keywords=[])], ctx=Load())), If(test=Name(id='crop', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='transforms', ctx=Load()), attr='append', ctx=Load()), args=[Call(func=Name(id='CenterCrop', ctx=Load()), args=[Name(id='image_size', ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_transform', ctx=Store())], value=Call(func=Name(id='Compose', ctx=Load()), args=[Name(id='transforms', ctx=Load())], keywords=[]))], decorator_list=[])], decorator_list=[]), If(test=Compare(left=Name(id='__name__', ctx=Load()), ops=[Eq()], comparators=[Constant(value='__main__')]), body=[Assign(targets=[Name(id='args', ctx=Store())], value=Call(func=Name(id='parse_argum', ctx=Load()), args=[], keywords=[])), Expr(value=Call(func=Name(id='ma_in', ctx=Load()), args=[Name(id='args', ctx=Load())], keywords=[]))], orelse=[])], type_ignores=[])