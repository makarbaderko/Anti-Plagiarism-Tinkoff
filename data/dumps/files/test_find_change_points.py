Module(body=[ImportFrom(module='typing', names=[alias(name='Dict')], level=0), ImportFrom(module='typing', names=[alias(name='List')], level=0), Import(names=[alias(name='numpy', asname='np')]), Import(names=[alias(name='pandas', asname='pd')]), Import(names=[alias(name='pytest')]), ImportFrom(module='ruptures', names=[alias(name='Binseg')], level=0), ImportFrom(module='etna.analysis', names=[alias(name='find_change_points')], level=0), ImportFrom(module='etna.datasets', names=[alias(name='TSDataset')], level=0), FunctionDef(name='check_change_points', args=arguments(posonlyargs=[], args=[arg(arg='change_points', annotation=Subscript(value=Name(id='Dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Subscript(value=Name(id='List', ctx=Load()), slice=Attribute(value=Name(id='pd', ctx=Load()), attr='Timestamp', ctx=Load()), ctx=Load())], ctx=Load()), ctx=Load())), arg(arg='segments', annotation=Subscript(value=Name(id='List', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load())), arg(arg='num_points', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Check change points on validity.')), Assert(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='change_points', ctx=Load()), Name(id='dict', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='set', ctx=Load()), args=[Call(func=Attribute(value=Name(id='change_points', ctx=Load()), attr='keys', ctx=Load()), args=[], keywords=[])], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='set', ctx=Load()), args=[Name(id='segments', ctx=Load())], keywords=[])])), For(target=Name(id='segment', ctx=Store()), iter=Name(id='segments', ctx=Load()), body=[Assign(targets=[Name(id='change_points_segment', ctx=Store())], value=Subscript(value=Name(id='change_points', ctx=Load()), slice=Name(id='segment', ctx=Load()), ctx=Load())), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='change_points_segment', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='num_points', ctx=Load())])), For(target=Name(id='point', ctx=Store()), iter=Name(id='change_points_segment', ctx=Load()), body=[Assert(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='point', ctx=Load()), Attribute(value=Name(id='pd', ctx=Load()), attr='Timestamp', ctx=Load())], keywords=[]))], orelse=[])], orelse=[])], decorator_list=[]), FunctionDef(name='test_find_change_points_simple', args=arguments(posonlyargs=[], args=[arg(arg='multitrend_df', annotation=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), arg(arg='n_bkps', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that find_change_points works fine with multitrend example.')), Assign(targets=[Name(id='ts', ctx=Store())], value=Call(func=Name(id='TSDataset', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='multitrend_df', ctx=Load())), keyword(arg='freq', value=Constant(value='D'))])), Assign(targets=[Name(id='change_points', ctx=Store())], value=Call(func=Name(id='find_change_points', ctx=Load()), args=[], keywords=[keyword(arg='ts', value=Name(id='ts', ctx=Load())), keyword(arg='in_column', value=Constant(value='target')), keyword(arg='change_point_model', value=Call(func=Name(id='Binseg', ctx=Load()), args=[], keywords=[])), keyword(arg='n_bkps', value=Name(id='n_bkps', ctx=Load()))])), Expr(value=Call(func=Name(id='check_change_points', ctx=Load()), args=[Name(id='change_points', ctx=Load())], keywords=[keyword(arg='segments', value=Attribute(value=Name(id='ts', ctx=Load()), attr='segments', ctx=Load())), keyword(arg='num_points', value=Name(id='n_bkps', ctx=Load()))]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='n_bkps'), List(elts=[Constant(value=5), Constant(value=10), Constant(value=12), Constant(value=27)], ctx=Load())], keywords=[])]), FunctionDef(name='test_find_change_points_nans_head', args=arguments(posonlyargs=[], args=[arg(arg='multitrend_df', annotation=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), arg(arg='n_bkps', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that find_change_points works fine with nans at the beginning of the series.')), Assign(targets=[Subscript(value=Attribute(value=Name(id='multitrend_df', ctx=Load()), attr='iloc', ctx=Load()), slice=Tuple(elts=[Slice(upper=Constant(value=5)), Slice()], ctx=Load()), ctx=Store())], value=Attribute(value=Name(id='np', ctx=Load()), attr='NaN', ctx=Load())), Assign(targets=[Name(id='ts', ctx=Store())], value=Call(func=Name(id='TSDataset', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='multitrend_df', ctx=Load())), keyword(arg='freq', value=Constant(value='D'))])), Assign(targets=[Name(id='change_points', ctx=Store())], value=Call(func=Name(id='find_change_points', ctx=Load()), args=[], keywords=[keyword(arg='ts', value=Name(id='ts', ctx=Load())), keyword(arg='in_column', value=Constant(value='target')), keyword(arg='change_point_model', value=Call(func=Name(id='Binseg', ctx=Load()), args=[], keywords=[])), keyword(arg='n_bkps', value=Name(id='n_bkps', ctx=Load()))])), Expr(value=Call(func=Name(id='check_change_points', ctx=Load()), args=[Name(id='change_points', ctx=Load())], keywords=[keyword(arg='segments', value=Attribute(value=Name(id='ts', ctx=Load()), attr='segments', ctx=Load())), keyword(arg='num_points', value=Name(id='n_bkps', ctx=Load()))]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='n_bkps'), List(elts=[Constant(value=5), Constant(value=10), Constant(value=12), Constant(value=27)], ctx=Load())], keywords=[])]), FunctionDef(name='test_find_change_points_nans_tail', args=arguments(posonlyargs=[], args=[arg(arg='multitrend_df', annotation=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), arg(arg='n_bkps', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that find_change_points works fine with nans at the end of the series.')), Assign(targets=[Subscript(value=Attribute(value=Name(id='multitrend_df', ctx=Load()), attr='iloc', ctx=Load()), slice=Tuple(elts=[Slice(lower=UnaryOp(op=USub(), operand=Constant(value=5))), Slice()], ctx=Load()), ctx=Store())], value=Attribute(value=Name(id='np', ctx=Load()), attr='NaN', ctx=Load())), Assign(targets=[Name(id='ts', ctx=Store())], value=Call(func=Name(id='TSDataset', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='multitrend_df', ctx=Load())), keyword(arg='freq', value=Constant(value='D'))])), Assign(targets=[Name(id='change_points', ctx=Store())], value=Call(func=Name(id='find_change_points', ctx=Load()), args=[], keywords=[keyword(arg='ts', value=Name(id='ts', ctx=Load())), keyword(arg='in_column', value=Constant(value='target')), keyword(arg='change_point_model', value=Call(func=Name(id='Binseg', ctx=Load()), args=[], keywords=[])), keyword(arg='n_bkps', value=Name(id='n_bkps', ctx=Load()))])), Expr(value=Call(func=Name(id='check_change_points', ctx=Load()), args=[Name(id='change_points', ctx=Load())], keywords=[keyword(arg='segments', value=Attribute(value=Name(id='ts', ctx=Load()), attr='segments', ctx=Load())), keyword(arg='num_points', value=Name(id='n_bkps', ctx=Load()))]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='n_bkps'), List(elts=[Constant(value=5), Constant(value=10), Constant(value=12), Constant(value=27)], ctx=Load())], keywords=[])])], type_ignores=[])