Module(body=[Import(names=[alias(name='numpy', asname='np')]), Import(names=[alias(name='pandas', asname='pd')]), Import(names=[alias(name='pytest')]), ImportFrom(module='etna.datasets', names=[alias(name='TSDataset')], level=0), ImportFrom(module='etna.datasets', names=[alias(name='duplicate_data')], level=0), ImportFrom(module='etna.datasets', names=[alias(name='generate_ar_df')], level=0), ImportFrom(module='etna.datasets.utils', names=[alias(name='_TorchDataset')], level=0), ImportFrom(module='etna.datasets.utils', names=[alias(name='set_columns_wide')], level=0), FunctionDef(name='df_exog_no_segments', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='timestamp', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='date_range', ctx=Load()), args=[Constant(value='2020-01-01')], keywords=[keyword(arg='periods', value=Constant(value=100)), keyword(arg='freq', value=Constant(value='D'))])), Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load()), args=[Dict(keys=[Constant(value='timestamp'), Constant(value='exog_1'), Constant(value='exog_2'), Constant(value='exog_3')], values=[Name(id='timestamp', ctx=Load()), Constant(value=1), Constant(value=2), Constant(value=3)])], keywords=[])), Return(value=Name(id='df', ctx=Load()))], decorator_list=[Attribute(value=Name(id='pytest', ctx=Load()), attr='fixture', ctx=Load())], returns=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), FunctionDef(name='test_duplicate_data_fail_empty_segments', args=arguments(posonlyargs=[], args=[arg(arg='df_exog_no_segments')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that `duplicate_data` fails on empty list of segments.')), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Name(id='ValueError', ctx=Load())], keywords=[keyword(arg='match', value=Constant(value="Parameter segments shouldn't be empty"))]))], body=[Assign(targets=[Name(id='_', ctx=Store())], value=Call(func=Name(id='duplicate_data', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df_exog_no_segments', ctx=Load())), keyword(arg='segments', value=List(elts=[], ctx=Load()))]))])], decorator_list=[]), FunctionDef(name='test_duplicate_data_fail_wrong_format', args=arguments(posonlyargs=[], args=[arg(arg='df_exog_no_segments')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that `duplicate_data` fails on wrong given format.')), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Name(id='ValueError', ctx=Load())], keywords=[keyword(arg='match', value=Constant(value="'wrong_format' is not a valid DataFrameFormat"))]))], body=[Assign(targets=[Name(id='_', ctx=Store())], value=Call(func=Name(id='duplicate_data', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df_exog_no_segments', ctx=Load())), keyword(arg='segments', value=List(elts=[Constant(value='segment_1'), Constant(value='segment_2')], ctx=Load())), keyword(arg='format', value=Constant(value='wrong_format'))]))])], decorator_list=[]), FunctionDef(name='test_duplicate_data_fail_wrong_df', args=arguments(posonlyargs=[], args=[arg(arg='df_exog_no_segments')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that `duplicate_data` fails on wrong df.')), With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Name(id='ValueError', ctx=Load())], keywords=[keyword(arg='match', value=Constant(value="There should be 'timestamp' column"))]))], body=[Assign(targets=[Name(id='_', ctx=Store())], value=Call(func=Name(id='duplicate_data', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Call(func=Attribute(value=Name(id='df_exog_no_segments', ctx=Load()), attr='drop', ctx=Load()), args=[], keywords=[keyword(arg='columns', value=List(elts=[Constant(value='timestamp')], ctx=Load()))])), keyword(arg='segments', value=List(elts=[Constant(value='segment_1'), Constant(value='segment_2')], ctx=Load()))]))])], decorator_list=[]), FunctionDef(name='test_duplicate_data_long_format', args=arguments(posonlyargs=[], args=[arg(arg='df_exog_no_segments')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that `duplicate_data` makes duplication in long format.')), Assign(targets=[Name(id='segments', ctx=Store())], value=List(elts=[Constant(value='segment_1'), Constant(value='segment_2')], ctx=Load())), Assign(targets=[Name(id='df_duplicated', ctx=Store())], value=Call(func=Name(id='duplicate_data', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df_exog_no_segments', ctx=Load())), keyword(arg='segments', value=Name(id='segments', ctx=Load())), keyword(arg='format', value=Constant(value='long'))])), Assign(targets=[Name(id='expected_columns', ctx=Store())], value=Call(func=Name(id='set', ctx=Load()), args=[Attribute(value=Name(id='df_exog_no_segments', ctx=Load()), attr='columns', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='expected_columns', ctx=Load()), attr='add', ctx=Load()), args=[Constant(value='segment')], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='set', ctx=Load()), args=[Attribute(value=Name(id='df_duplicated', ctx=Load()), attr='columns', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected_columns', ctx=Load())])), For(target=Name(id='segment', ctx=Store()), iter=Name(id='segments', ctx=Load()), body=[Assign(targets=[Name(id='df_temp', ctx=Store())], value=Call(func=Attribute(value=Subscript(value=Name(id='df_duplicated', ctx=Load()), slice=Compare(left=Subscript(value=Name(id='df_duplicated', ctx=Load()), slice=Constant(value='segment'), ctx=Load()), ops=[Eq()], comparators=[Name(id='segment', ctx=Load())]), ctx=Load()), attr='reset_index', ctx=Load()), args=[], keywords=[keyword(arg='drop', value=Constant(value=True))])), For(target=Name(id='column', ctx=Store()), iter=Attribute(value=Name(id='df_exog_no_segments', ctx=Load()), attr='columns', ctx=Load()), body=[Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Subscript(value=Name(id='df_temp', ctx=Load()), slice=Name(id='column', ctx=Load()), ctx=Load()), ops=[Eq()], comparators=[Subscript(value=Name(id='df_exog_no_segments', ctx=Load()), slice=Name(id='column', ctx=Load()), ctx=Load())])], keywords=[]))], orelse=[])], orelse=[])], decorator_list=[]), FunctionDef(name='test_duplicate_data_wide_format', args=arguments(posonlyargs=[], args=[arg(arg='df_exog_no_segments')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Test that `duplicate_data` makes duplication in wide format.')), Assign(targets=[Name(id='segments', ctx=Store())], value=List(elts=[Constant(value='segment_1'), Constant(value='segment_2')], ctx=Load())), Assign(targets=[Name(id='df_duplicated', ctx=Store())], value=Call(func=Name(id='duplicate_data', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df_exog_no_segments', ctx=Load())), keyword(arg='segments', value=Name(id='segments', ctx=Load())), keyword(arg='format', value=Constant(value='wide'))])), Assign(targets=[Name(id='expected_columns_segment', ctx=Store())], value=Call(func=Name(id='set', ctx=Load()), args=[Attribute(value=Name(id='df_exog_no_segments', ctx=Load()), attr='columns', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='expected_columns_segment', ctx=Load()), attr='remove', ctx=Load()), args=[Constant(value='timestamp')], keywords=[])), For(target=Name(id='segment', ctx=Store()), iter=Name(id='segments', ctx=Load()), body=[Assign(targets=[Name(id='df_temp', ctx=Store())], value=Subscript(value=Attribute(value=Name(id='df_duplicated', ctx=Load()), attr='loc', ctx=Load()), slice=Tuple(elts=[Slice(), Subscript(value=Attribute(value=Name(id='pd', ctx=Load()), attr='IndexSlice', ctx=Load()), slice=Tuple(elts=[Name(id='segment', ctx=Load()), Slice()], ctx=Load()), ctx=Load())], ctx=Load()), ctx=Load())), Assign(targets=[Attribute(value=Name(id='df_temp', ctx=Load()), attr='columns', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='df_temp', ctx=Load()), attr='columns', ctx=Load()), attr='droplevel', ctx=Load()), args=[Constant(value='segment')], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='set', ctx=Load()), args=[Attribute(value=Name(id='df_temp', ctx=Load()), attr='columns', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected_columns_segment', ctx=Load())])), Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Attribute(value=Name(id='df_temp', ctx=Load()), attr='index', ctx=Load()), ops=[Eq()], comparators=[Subscript(value=Name(id='df_exog_no_segments', ctx=Load()), slice=Constant(value='timestamp'), ctx=Load())])], keywords=[])), For(target=Name(id='column', ctx=Store()), iter=Call(func=Attribute(value=Attribute(value=Name(id='df_exog_no_segments', ctx=Load()), attr='columns', ctx=Load()), attr='drop', ctx=Load()), args=[Constant(value='timestamp')], keywords=[]), body=[Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Attribute(value=Subscript(value=Name(id='df_temp', ctx=Load()), slice=Name(id='column', ctx=Load()), ctx=Load()), attr='values', ctx=Load()), ops=[Eq()], comparators=[Attribute(value=Subscript(value=Name(id='df_exog_no_segments', ctx=Load()), slice=Name(id='column', ctx=Load()), ctx=Load()), attr='values', ctx=Load())])], keywords=[]))], orelse=[])], orelse=[])], decorator_list=[]), FunctionDef(name='test_torch_dataset', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Unit test for `_TorchDataset` class.')), Assign(targets=[Name(id='ts_samples', ctx=Store())], value=List(elts=[Dict(keys=[Constant(value='decoder_target'), Constant(value='encoder_target')], values=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())], keywords=[]), Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())], keywords=[])])], ctx=Load())), Assign(targets=[Name(id='torch_dataset', ctx=Store())], value=Call(func=Name(id='_TorchDataset', ctx=Load()), args=[], keywords=[keyword(arg='ts_samples', value=Name(id='ts_samples', ctx=Load()))])), Assert(test=Compare(left=Subscript(value=Name(id='torch_dataset', ctx=Load()), slice=Constant(value=0), ctx=Load()), ops=[Eq()], comparators=[Subscript(value=Name(id='ts_samples', ctx=Load()), slice=Constant(value=0), ctx=Load())])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='torch_dataset', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]))], decorator_list=[]), FunctionDef(name='_get_df_wide', args=arguments(posonlyargs=[], args=[arg(arg='random_seed', annotation=Name(id='int', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Name(id='generate_ar_df', ctx=Load()), args=[], keywords=[keyword(arg='periods', value=Constant(value=5)), keyword(arg='start_time', value=Constant(value='2020-01-01')), keyword(arg='n_segments', value=Constant(value=3)), keyword(arg='random_seed', value=Name(id='random_seed', ctx=Load()))])), Assign(targets=[Name(id='df_wide', ctx=Store())], value=Call(func=Attribute(value=Name(id='TSDataset', ctx=Load()), attr='to_dataset', ctx=Load()), args=[Name(id='df', ctx=Load())], keywords=[])), Assign(targets=[Name(id='df_exog', ctx=Store())], value=Call(func=Attribute(value=Name(id='df', ctx=Load()), attr='copy', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='df_exog', ctx=Store())], value=Call(func=Attribute(value=Name(id='df_exog', ctx=Load()), attr='rename', ctx=Load()), args=[], keywords=[keyword(arg='columns', value=Dict(keys=[Constant(value='target')], values=[Constant(value='exog_0')]))])), Assign(targets=[Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_0'), ctx=Store())], value=BinOp(left=Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_0'), ctx=Load()), op=Add(), right=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_1'), ctx=Store())], value=BinOp(left=Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_0'), ctx=Load()), op=Add(), right=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_2'), ctx=Store())], value=BinOp(left=Subscript(value=Name(id='df_exog', ctx=Load()), slice=Constant(value='exog_1'), ctx=Load()), op=Add(), right=Constant(value=1))), Assign(targets=[Name(id='df_exog_wide', ctx=Store())], value=Call(func=Attribute(value=Name(id='TSDataset', ctx=Load()), attr='to_dataset', ctx=Load()), args=[Name(id='df_exog', ctx=Load())], keywords=[])), Assign(targets=[Name(id='ts', ctx=Store())], value=Call(func=Name(id='TSDataset', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df_wide', ctx=Load())), keyword(arg='df_exog', value=Name(id='df_exog_wide', ctx=Load())), keyword(arg='freq', value=Constant(value='D'))])), Assign(targets=[Name(id='df', ctx=Store())], value=Attribute(value=Name(id='ts', ctx=Load()), attr='df', ctx=Load())), Assign(targets=[Name(id='df', ctx=Store())], value=Subscript(value=Attribute(value=Name(id='df', ctx=Load()), attr='loc', ctx=Load()), slice=Tuple(elts=[Slice(), Subscript(value=Attribute(value=Name(id='pd', ctx=Load()), attr='IndexSlice', ctx=Load()), slice=Tuple(elts=[List(elts=[Constant(value='segment_2'), Constant(value='segment_0'), Constant(value='segment_1')], ctx=Load()), List(elts=[Constant(value='target'), Constant(value='exog_2'), Constant(value='exog_1'), Constant(value='exog_0')], ctx=Load())], ctx=Load()), ctx=Load())], ctx=Load()), ctx=Load())), Return(value=Name(id='df', ctx=Load()))], decorator_list=[], returns=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), FunctionDef(name='df_left', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='_get_df_wide', ctx=Load()), args=[Constant(value=0)], keywords=[]))], decorator_list=[Attribute(value=Name(id='pytest', ctx=Load()), attr='fixture', ctx=Load())], returns=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), FunctionDef(name='df_right', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Return(value=Call(func=Name(id='_get_df_wide', ctx=Load()), args=[Constant(value=1)], keywords=[]))], decorator_list=[Attribute(value=Name(id='pytest', ctx=Load()), attr='fixture', ctx=Load())], returns=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load())), FunctionDef(name='test_set_columns_wide', args=arguments(posonlyargs=[], args=[arg(arg='timestamps_idx_left'), arg(arg='timestamps_idx_right'), arg(arg='segments_left'), arg(arg='segment_right'), arg(arg='features_left'), arg(arg='features_right'), arg(arg='df_left'), arg(arg='df_right')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='timestamps_left', ctx=Store())], value=IfExp(test=Compare(left=Name(id='timestamps_idx_left', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Constant(value=None), orelse=Subscript(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='index', ctx=Load()), slice=Name(id='timestamps_idx_left', ctx=Load()), ctx=Load()))), Assign(targets=[Name(id='timestamps_right', ctx=Store())], value=IfExp(test=Compare(left=Name(id='timestamps_idx_right', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Constant(value=None), orelse=Subscript(value=Attribute(value=Name(id='df_right', ctx=Load()), attr='index', ctx=Load()), slice=Name(id='timestamps_idx_right', ctx=Load()), ctx=Load()))), Assign(targets=[Name(id='df_obtained', ctx=Store())], value=Call(func=Name(id='set_columns_wide', ctx=Load()), args=[Name(id='df_left', ctx=Load()), Name(id='df_right', ctx=Load())], keywords=[keyword(arg='timestamps_left', value=Name(id='timestamps_left', ctx=Load())), keyword(arg='timestamps_right', value=Name(id='timestamps_right', ctx=Load())), keyword(arg='segments_left', value=Name(id='segments_left', ctx=Load())), keyword(arg='segments_right', value=Name(id='segment_right', ctx=Load())), keyword(arg='features_left', value=Name(id='features_left', ctx=Load())), keyword(arg='features_right', value=Name(id='features_right', ctx=Load()))])), Assign(targets=[Name(id='df_expected', ctx=Store())], value=Call(func=Attribute(value=Name(id='df_left', ctx=Load()), attr='copy', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='timestamps_left_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='timestamps_left', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='index', ctx=Load()), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='timestamps_left', ctx=Load()))), Assign(targets=[Name(id='timestamps_right_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='timestamps_left', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Attribute(value=Name(id='df_right', ctx=Load()), attr='index', ctx=Load()), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='timestamps_right', ctx=Load()))), Assign(targets=[Name(id='segments_left_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='segments_left', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='columns', ctx=Load()), attr='get_level_values', ctx=Load()), args=[Constant(value='segment')], keywords=[]), attr='unique', ctx=Load()), args=[], keywords=[]), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='segments_left', ctx=Load()))), Assign(targets=[Name(id='segments_right_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='segment_right', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='columns', ctx=Load()), attr='get_level_values', ctx=Load()), args=[Constant(value='segment')], keywords=[]), attr='unique', ctx=Load()), args=[], keywords=[]), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='segment_right', ctx=Load()))), Assign(targets=[Name(id='features_left_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='features_left', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='columns', ctx=Load()), attr='get_level_values', ctx=Load()), args=[Constant(value='feature')], keywords=[]), attr='unique', ctx=Load()), args=[], keywords=[]), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='features_left', ctx=Load()))), Assign(targets=[Name(id='features_right_full', ctx=Store())], value=IfExp(test=Compare(left=Name(id='features_right', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=Call(func=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='df_left', ctx=Load()), attr='columns', ctx=Load()), attr='get_level_values', ctx=Load()), args=[Constant(value='feature')], keywords=[]), attr='unique', ctx=Load()), args=[], keywords=[]), attr='tolist', ctx=Load()), args=[], keywords=[]), orelse=Name(id='features_right', ctx=Load()))), Assign(targets=[Name(id='right_value', ctx=Store())], value=Subscript(value=Attribute(value=Name(id='df_right', ctx=Load()), attr='loc', ctx=Load()), slice=Tuple(elts=[Name(id='timestamps_right_full', ctx=Load()), Subscript(value=Attribute(value=Name(id='pd', ctx=Load()), attr='IndexSlice', ctx=Load()), slice=Tuple(elts=[Name(id='segments_right_full', ctx=Load()), Name(id='features_right_full', ctx=Load())], ctx=Load()), ctx=Load())], ctx=Load()), ctx=Load())), Assign(targets=[Subscript(value=Attribute(value=Name(id='df_expected', ctx=Load()), attr='loc', ctx=Load()), slice=Tuple(elts=[Name(id='timestamps_left_full', ctx=Load()), Subscript(value=Attribute(value=Name(id='pd', ctx=Load()), attr='IndexSlice', ctx=Load()), slice=Tuple(elts=[Name(id='segments_left_full', ctx=Load()), Name(id='features_left_full', ctx=Load())], ctx=Load()), ctx=Load())], ctx=Load()), ctx=Store())], value=Attribute(value=Name(id='right_value', ctx=Load()), attr='values', ctx=Load())), Assign(targets=[Name(id='df_expected', ctx=Store())], value=Call(func=Attribute(value=Name(id='df_expected', ctx=Load()), attr='sort_index', ctx=Load()), args=[], keywords=[keyword(arg='axis', value=Constant(value=1))])), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='pd', ctx=Load()), attr='testing', ctx=Load()), attr='assert_frame_equal', ctx=Load()), args=[Name(id='df_obtained', ctx=Load()), Name(id='df_expected', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='features_left, features_right'), List(elts=[Tuple(elts=[Constant(value=None), Constant(value=None)], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='exog_0')], ctx=Load()), List(elts=[Constant(value='exog_0')], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='exog_0'), Constant(value='exog_1')], ctx=Load()), List(elts=[Constant(value='exog_0'), Constant(value='exog_1')], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='exog_0'), Constant(value='exog_1')], ctx=Load()), List(elts=[Constant(value='exog_1'), Constant(value='exog_2')], ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='segments_left, segment_right'), List(elts=[Tuple(elts=[Constant(value=None), Constant(value=None)], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='segment_0')], ctx=Load()), List(elts=[Constant(value='segment_0')], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='segment_0'), Constant(value='segment_1')], ctx=Load()), List(elts=[Constant(value='segment_0'), Constant(value='segment_1')], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value='segment_0'), Constant(value='segment_1')], ctx=Load()), List(elts=[Constant(value='segment_1'), Constant(value='segment_2')], ctx=Load())], ctx=Load())], ctx=Load())], keywords=[]), Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='timestamps_idx_left, timestamps_idx_right'), List(elts=[Tuple(elts=[Constant(value=None), Constant(value=None)], ctx=Load()), Tuple(elts=[List(elts=[Constant(value=0)], ctx=Load()), List(elts=[Constant(value=0)], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), List(elts=[Constant(value=3), Constant(value=4)], ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])])], type_ignores=[])