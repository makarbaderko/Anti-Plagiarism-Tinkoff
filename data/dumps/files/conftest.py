Module(body=[Import(names=[alias(name='pandas', asname='pd')]), Import(names=[alias(name='pytest')]), ImportFrom(module='etna.datasets', names=[alias(name='TSDataset')], level=0), ImportFrom(module='etna.datasets', names=[alias(name='generate_ar_df')], level=0), FunctionDef(name='ts_with_exog', args=arguments(posonlyargs=[], args=[arg(arg='random_seed')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Name(id='generate_ar_df', ctx=Load()), args=[], keywords=[keyword(arg='periods', value=Constant(value=100)), keyword(arg='start_time', value=Constant(value='2020-01-01')), keyword(arg='n_segments', value=Constant(value=4))])), Assign(targets=[Name(id='df_exog_1', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='generate_ar_df', ctx=Load()), args=[], keywords=[keyword(arg='periods', value=Constant(value=100)), keyword(arg='start_time', value=Constant(value='2020-01-01')), keyword(arg='n_segments', value=Constant(value=4)), keyword(arg='random_seed', value=Constant(value=2))]), attr='rename', ctx=Load()), args=[Dict(keys=[Constant(value='target')], values=[Constant(value='exog')])], keywords=[keyword(arg='axis', value=Constant(value=1))])), Assign(targets=[Name(id='df_exog_2', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='generate_ar_df', ctx=Load()), args=[], keywords=[keyword(arg='periods', value=Constant(value=150)), keyword(arg='start_time', value=Constant(value='2019-12-01')), keyword(arg='n_segments', value=Constant(value=4)), keyword(arg='random_seed', value=Constant(value=3))]), attr='rename', ctx=Load()), args=[Dict(keys=[Constant(value='target')], values=[Constant(value='regressor_1')])], keywords=[keyword(arg='axis', value=Constant(value=1))])), Assign(targets=[Name(id='df_exog_3', ctx=Store())], value=Call(func=Attribute(value=Call(func=Name(id='generate_ar_df', ctx=Load()), args=[], keywords=[keyword(arg='periods', value=Constant(value=150)), keyword(arg='start_time', value=Constant(value='2019-12-01')), keyword(arg='n_segments', value=Constant(value=4)), keyword(arg='random_seed', value=Constant(value=4))]), attr='rename', ctx=Load()), args=[Dict(keys=[Constant(value='target')], values=[Constant(value='regressor_2')])], keywords=[keyword(arg='axis', value=Constant(value=1))])), Assign(targets=[Name(id='df_exog', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='merge', ctx=Load()), args=[Name(id='df_exog_1', ctx=Load()), Name(id='df_exog_2', ctx=Load())], keywords=[keyword(arg='on', value=List(elts=[Constant(value='timestamp'), Constant(value='segment')], ctx=Load())), keyword(arg='how', value=Constant(value='right'))])), Assign(targets=[Name(id='df_exog', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='merge', ctx=Load()), args=[Name(id='df_exog', ctx=Load()), Name(id='df_exog_3', ctx=Load())], keywords=[keyword(arg='on', value=List(elts=[Constant(value='timestamp'), Constant(value='segment')], ctx=Load()))])), Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Attribute(value=Name(id='TSDataset', ctx=Load()), attr='to_dataset', ctx=Load()), args=[Name(id='df', ctx=Load())], keywords=[])), Assign(targets=[Name(id='df_exog', ctx=Store())], value=Call(func=Attribute(value=Name(id='TSDataset', ctx=Load()), attr='to_dataset', ctx=Load()), args=[Name(id='df_exog', ctx=Load())], keywords=[])), Assign(targets=[Name(id='ts', ctx=Store())], value=Call(func=Name(id='TSDataset', ctx=Load()), args=[], keywords=[keyword(arg='df', value=Name(id='df', ctx=Load())), keyword(arg='freq', value=Constant(value='D')), keyword(arg='df_exog', value=Name(id='df_exog', ctx=Load())), keyword(arg='known_future', value=List(elts=[Constant(value='regressor_1'), Constant(value='regressor_2')], ctx=Load()))])), Return(value=Name(id='ts', ctx=Load()))], decorator_list=[Attribute(value=Name(id='pytest', ctx=Load()), attr='fixture', ctx=Load())], returns=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load()))], type_ignores=[])