Module(body=[Import(names=[alias(name='pytest')]), ImportFrom(module='etna.models', names=[alias(name='LinearPerSegmentModel')], level=0), ImportFrom(module='etna.pipeline', names=[alias(name='Pipeline')], level=0), ImportFrom(module='etna.pipeline', names=[alias(name='assemble_pipelines')], level=0), ImportFrom(module='etna.transforms', names=[alias(name='LagTransform')], level=0), ImportFrom(module='etna.transforms', names=[alias(name='TrendTransform')], level=0), FunctionDef(name='test_not_equal_lengths', args=arguments(posonlyargs=[], args=[arg(arg='models'), arg(arg='transforms'), arg(arg='horizons'), arg(arg='message')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[With(items=[withitem(context_expr=Call(func=Attribute(value=Name(id='pytest', ctx=Load()), attr='raises', ctx=Load()), args=[Name(id='ValueError', ctx=Load())], keywords=[keyword(arg='match', value=Name(id='message', ctx=Load()))]))], body=[Assign(targets=[Name(id='_', ctx=Store())], value=Call(func=Name(id='assemble_pipelines', ctx=Load()), args=[Name(id='models', ctx=Load()), Name(id='transforms', ctx=Load()), Name(id='horizons', ctx=Load())], keywords=[]))])], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='models, transforms, horizons, message'), List(elts=[Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load()), Constant(value='Lengths of the result models is not equals to horizons or transforms')], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load()), Constant(value='Lengths of the result transforms is not equals to models or horizons')], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value='Lengths of the result horizons is not equals to models or transforms')], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_output_pipelines', args=arguments(posonlyargs=[], args=[arg(arg='models'), arg(arg='transforms'), arg(arg='horizons'), arg(arg='expected_len')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='  ͛     ˽   Ľ')), Assign(targets=[Name(id='pipelines', ctx=Store())], value=Call(func=Name(id='assemble_pipelines', ctx=Load()), args=[Name(id='models', ctx=Load()), Name(id='transforms', ctx=Load()), Name(id='horizons', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='pipelines', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected_len', ctx=Load())])), For(target=Name(id='pipeline', ctx=Store()), iter=Name(id='pipelines', ctx=Load()), body=[Assert(test=Call(func=Name(id='isinstance', ctx=Load()), args=[Name(id='pipeline', ctx=Load()), Name(id='Pipeline', ctx=Load())], keywords=[]))], orelse=[])], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='models, transforms, horizons, expected_len'), List(elts=[Tuple(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), Constant(value=1), Constant(value=1)], ctx=Load()), Tuple(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value=2)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), Constant(value=1), Constant(value=2)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Constant(value=None)], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load()), Constant(value=3)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value=2)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value=2)], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_none_in_tranforms', args=arguments(posonlyargs=[], args=[arg(arg='models'), arg(arg='transforms'), arg(arg='horizons'), arg(arg='expected_transforms_lens')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='pipelines', ctx=Store())], value=Call(func=Name(id='assemble_pipelines', ctx=Load()), args=[Name(id='models', ctx=Load()), Name(id='transforms', ctx=Load()), Name(id='horizons', ctx=Load())], keywords=[])), Assert(test=Compare(left=ListComp(elt=Call(func=Name(id='len', ctx=Load()), args=[Attribute(value=Name(id='pipeline', ctx=Load()), attr='transforms', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='pipeline', ctx=Store()), iter=Name(id='pipelines', ctx=Load()), ifs=[], is_async=0)]), ops=[Eq()], comparators=[Name(id='expected_transforms_lens', ctx=Load())]))], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='models, transforms, horizons, expected_transforms_lens'), List(elts=[Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Constant(value=None)], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), List(elts=[Constant(value=2), Constant(value=1)], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Constant(value=None), List(elts=[Constant(value=None), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), List(elts=[Constant(value=0), Constant(value=1)], ctx=Load())], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Constant(value=None)], ctx=Load()), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Constant(value=None)], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), List(elts=[Constant(value=3), Constant(value=1)], ctx=Load())], ctx=Load())], ctx=Load())], keywords=[])]), FunctionDef(name='test_different_objects', args=arguments(posonlyargs=[], args=[], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='models', ctx=Store())], value=Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='transforms', ctx=Store())], value=List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())), Assign(targets=[Name(id='horizons', ctx=Store())], value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3), Constant(value=4), Constant(value=5)], ctx=Load())), Assign(targets=[Name(id='pipelines', ctx=Store())], value=Call(func=Name(id='assemble_pipelines', ctx=Load()), args=[Name(id='models', ctx=Load()), Name(id='transforms', ctx=Load()), Name(id='horizons', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[SetComp(elt=Call(func=Name(id='id', ctx=Load()), args=[Attribute(value=Name(id='pipeline', ctx=Load()), attr='model', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='pipeline', ctx=Store()), iter=Name(id='pipelines', ctx=Load()), ifs=[], is_async=0)])], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='pipelines', ctx=Load())], keywords=[])])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[SetComp(elt=Call(func=Name(id='id', ctx=Load()), args=[Attribute(value=Name(id='pipeline', ctx=Load()), attr='horizon', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='pipeline', ctx=Store()), iter=Name(id='pipelines', ctx=Load()), ifs=[], is_async=0)])], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='pipelines', ctx=Load())], keywords=[])]))], decorator_list=[]), FunctionDef(name='test_transofrms_lengths', args=arguments(posonlyargs=[], args=[arg(arg='models'), arg(arg='transforms'), arg(arg='horizons'), arg(arg='expected_len')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='pipelines', ctx=Store())], value=Call(func=Name(id='assemble_pipelines', ctx=Load()), args=[Name(id='models', ctx=Load()), Name(id='transforms', ctx=Load()), Name(id='horizons', ctx=Load())], keywords=[])), For(target=Name(id='pipeline', ctx=Store()), iter=Name(id='pipelines', ctx=Load()), body=[Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Attribute(value=Name(id='pipeline', ctx=Load()), attr='transforms', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Name(id='expected_len', ctx=Load())]))], orelse=[])], decorator_list=[Call(func=Attribute(value=Attribute(value=Name(id='pytest', ctx=Load()), attr='mark', ctx=Load()), attr='parametrize', ctx=Load()), args=[Constant(value='models, transforms, horizons, expected_len'), List(elts=[Tuple(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), Constant(value=1), Constant(value=1)], ctx=Load()), Tuple(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value=2)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), Constant(value=1), Constant(value=2)], ctx=Load()), Tuple(elts=[List(elts=[Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[]), Call(func=Name(id='LinearPerSegmentModel', ctx=Load()), args=[], keywords=[])], ctx=Load()), List(elts=[Call(func=Name(id='TrendTransform', ctx=Load()), args=[], keywords=[keyword(arg='in_column', value=Constant(value='target'))]), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load()), List(elts=[Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=1), Constant(value=2), Constant(value=3)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))]), Call(func=Name(id='LagTransform', ctx=Load()), args=[], keywords=[keyword(arg='lags', value=List(elts=[Constant(value=2), Constant(value=3), Constant(value=4)], ctx=Load())), keyword(arg='in_column', value=Constant(value='target'))])], ctx=Load())], ctx=Load()), List(elts=[Constant(value=1), Constant(value=2)], ctx=Load()), Constant(value=3)], ctx=Load())], ctx=Load())], keywords=[])])], type_ignores=[])