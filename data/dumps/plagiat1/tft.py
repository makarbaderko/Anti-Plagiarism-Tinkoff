Module(body=[Import(names=[alias(name='warnings')]), ImportFrom(module='typing', names=[alias(name='Any')], level=0), ImportFrom(module='typing', names=[alias(name='Dict')], level=0), ImportFrom(module='typing', names=[alias(name='List')], level=0), ImportFrom(module='typing', names=[alias(name='Optional')], level=0), ImportFrom(module='typing', names=[alias(name='Sequence')], level=0), ImportFrom(module='typing', names=[alias(name='Union')], level=0), Import(names=[alias(name='pandas', asname='pd')]), ImportFrom(module='etna', names=[alias(name='SETTINGS')], level=0), ImportFrom(module='etna.transforms', names=[alias(name='PytorchForecastingTransform')], level=0), ImportFrom(module='etna.loggers', names=[alias(name='tslogger')], level=0), ImportFrom(module='etna.models.base', names=[alias(name='PredictionIntervalContextIgnorantAbstractModel')], level=0), ImportFrom(module='etna.models.base', names=[alias(name='log_decorator')], level=0), ImportFrom(module='etna.models.nn.utils', names=[alias(name='_DeepCopyMixin')], level=0), ImportFrom(module='etna.datasets.tsdataset', names=[alias(name='TSDataset')], level=0), If(test=Attribute(value=Name(id='SETTINGS', ctx=Load()), attr='torch_required', ctx=Load()), body=[Import(names=[alias(name='pytorch_lightning', asname='pl')]), ImportFrom(module='pytorch_forecasting.data', names=[alias(name='TimeSeriesDataSet')], level=0), ImportFrom(module='pytorch_forecasting.metrics', names=[alias(name='MultiHorizonMetric')], level=0), ImportFrom(module='pytorch_forecasting.metrics', names=[alias(name='QuantileLoss')], level=0), ImportFrom(module='pytorch_forecasting.models', names=[alias(name='TemporalFusionTransformer')], level=0), ImportFrom(module='pytorch_lightning', names=[alias(name='LightningModule')], level=0)], orelse=[]), ClassDef(name='TFTModel', bases=[Name(id='_DeepCopyMixin', ctx=Load()), Name(id='PredictionIntervalContextIgnorantAbstractModel', ctx=Load())], keywords=[], body=[Assign(targets=[Name(id='context_size', ctx=Store())], value=Constant(value=0)), FunctionDef(name='fit', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='ts', annotation=Name(id='TSDataset', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_last_train_timestamp', ctx=Store())], value=Subscript(value=Attribute(value=Attribute(value=Name(id='ts', ctx=Load()), attr='df', ctx=Load()), attr='index', ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_freq', ctx=Store())], value=Attribute(value=Name(id='ts', ctx=Load()), attr='freq', ctx=Load())), Assign(targets=[Name(id='pf_transform', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_get_pf_transform', ctx=Load()), args=[Name(id='ts', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_from_dataset', ctx=Load()), args=[Attribute(value=Name(id='pf_transform', ctx=Load()), attr='pf_dataset_train', ctx=Load())], keywords=[])), Assign(targets=[Name(id='trainer_kwargs', ctx=Store())], value=Call(func=Name(id='dict', ctx=Load()), args=[], keywords=[keyword(arg='logger', value=Attribute(value=Name(id='tslogger', ctx=Load()), attr='pl_loggers', ctx=Load())), keyword(arg='max_epochs', value=Attribute(value=Name(id='self', ctx=Load()), attr='max_epochs', ctx=Load())), keyword(arg='gpus', value=Attribute(value=Name(id='self', ctx=Load()), attr='gpus', ctx=Load())), keyword(arg='gradient_clip_val', value=Attribute(value=Name(id='self', ctx=Load()), attr='gradient_clip_val', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Name(id='trainer_kwargs', ctx=Load()), attr='update', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='trainer_kwargs', ctx=Load())], keywords=[])), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='trainer', ctx=Store())], value=Call(func=Attribute(value=Name(id='pl', ctx=Load()), attr='Trainer', ctx=Load()), args=[], keywords=[keyword(value=Name(id='trainer_kwargs', ctx=Load()))])), Assign(targets=[Name(id='train_dataloader', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pf_transform', ctx=Load()), attr='pf_dataset_train', ctx=Load()), attr='to_dataloader', ctx=Load()), args=[], keywords=[keyword(arg='train', value=Constant(value=True)), keyword(arg='batch_size', value=Attribute(value=Name(id='self', ctx=Load()), attr='batch_size', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='trainer', ctx=Load()), attr='fit', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Load()), Name(id='train_dataloader', ctx=Load())], keywords=[])), Return(value=Name(id='self', ctx=Load()))], decorator_list=[Name(id='log_decorator', ctx=Load())], returns=Constant(value='TFTModel')), FunctionDef(name='__init__', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='max_epochs', annotation=Name(id='int', ctx=Load())), arg(arg='gpus', annotation=Subscript(value=Name(id='Union', ctx=Load()), slice=Tuple(elts=[Name(id='int', ctx=Load()), Subscript(value=Name(id='List', ctx=Load()), slice=Name(id='int', ctx=Load()), ctx=Load())], ctx=Load()), ctx=Load())), arg(arg='gradient_clip_val', annotation=Name(id='float', ctx=Load())), arg(arg='learning_rate', annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Subscript(value=Name(id='List', ctx=Load()), slice=Name(id='float', ctx=Load()), ctx=Load()), ctx=Load())), arg(arg='batch_size', annotation=Name(id='int', ctx=Load())), arg(arg='context_length', annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Name(id='int', ctx=Load()), ctx=Load())), arg(arg='hidden_size', annotation=Name(id='int', ctx=Load())), arg(arg='lstm__layers', annotation=Name(id='int', ctx=Load())), arg(arg='attention_head_size', annotation=Name(id='int', ctx=Load())), arg(arg='dropout', annotation=Name(id='float', ctx=Load())), arg(arg='hidden_continuous_size', annotation=Name(id='int', ctx=Load())), arg(arg='loss', annotation=Constant(value='MultiHorizonMetric')), arg(arg='trainer_kwargs', annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Subscript(value=Name(id='Dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Name(id='Any', ctx=Load())], ctx=Load()), ctx=Load()), ctx=Load())), arg(arg='quantiles_kwargs', annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Subscript(value=Name(id='Dict', ctx=Load()), slice=Tuple(elts=[Name(id='str', ctx=Load()), Name(id='Any', ctx=Load())], ctx=Load()), ctx=Load()), ctx=Load()))], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[Constant(value=10), Constant(value=0), Constant(value=0.1), Constant(value=None), Constant(value=64), Constant(value=None), Constant(value=16), Constant(value=1), Constant(value=4), Constant(value=0.1), Constant(value=8), Constant(value=None), Constant(value=None), Constant(value=None)]), body=[Expr(value=Constant(value='Initiaɣlize TFT wraÅpper.\n\nParameters\n----------\nbatåch_size:\n    BatʃøchʧƆ)œ siŭzeŏ.\nconÝəËtext_lengt4h:\nˣǓ Β   Max encoderǳ lǏengtƟh, if Noneɞ max en͵coder length i[¼s equal to 2 hoĵriθzons.\nm̻ax_epochs:\n    MaxĦ eȪpochs.\ngpus:\nÍ    0 -ȁ iɥs ɤCPU, or [n_{i}] -/ʥ οtoϙ ̻choos\xade ʧn_{φi} GΦPU f̄rom cluster.\ngradie\x96nt_EýƓɨńclip_v~al:\n  ˃ ˸Ͳ ǔϢClippinɜg bϘy norm iͮs uƪsing, chùoo´se 0 toă not clip.\nYlearningɮʎ_rate:˼\n    Lea͝\x9brαning ratɓe.\nhiddĉen_sizeǩ:\n    Hiddͻen size of network w%hich ècan˙ rangĎe fkrom 8 ʭto 512.\nl\x91stm_layżåersŔ:\n    N͊umber of LS̯TM l§ayers.\nat͑tenteion_he\x86adͼ_siǁze:ɢ\n    Number of ̃aȸȁttention heads.\ndropout:\nγȃ    DroŔpout rĮaƙte˹.\nhȘidden_coQntiɗnuŏous_size:ɤ\n  ʧ  HiddenΉ size fłor processing continuous vͨariable̔s.\nloss:\n    ˼LoȆsǼs funcʆtƩåion taking̣ pǢrediŶct¯ion aõn5dȹ targets.\n    DefaultsϜ to ¤ʅ:p̒y:class:`pNyºtorch_fͰЀorecastinǦg.metɪricsͽ.QuantileLoss`.Ī\ntrainer_kĐw̥argƧ\xads:\n   Ʈ AddiȄìtional argumentȿs for p\x8aytorchȻͻ_lightningή Train̫ƾʆerǓ.\nquantUiles_ƕĳkwargs:\n    Additioͧnal ar˙gȜumentɌs ϰfor cʃomputing quant̨i/les, lookϾ at ``toʠ_ǝquantilesŖ()`ǀɿ` method forȺ Μyour loss.ã')), Expr(value=Call(func=Attribute(value=Call(func=Name(id='super', ctx=Load()), args=[], keywords=[]), attr='__init__', ctx=Load()), args=[], keywords=[])), If(test=Compare(left=Name(id='loss', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Assign(targets=[Name(id='loss', ctx=Store())], value=Call(func=Name(id='QuantileLoss', ctx=Load()), args=[], keywords=[]))], orelse=[]), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='max_epochs', ctx=Store())], value=Name(id='max_epochs', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='gpus', ctx=Store())], value=Name(id='gpus', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='gradient_clip_val', ctx=Store())], value=Name(id='gradient_clip_val', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='learning_rate', ctx=Store())], value=IfExp(test=Compare(left=Name(id='learning_rate', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=Name(id='learning_rate', ctx=Load()), orelse=List(elts=[Constant(value=0.001)], ctx=Load()))), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='horizon', ctx=Store())], value=Constant(value=None)), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='batch_size', ctx=Store())], value=Name(id='batch_size', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='context_length', ctx=Store())], value=Name(id='context_length', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='hidden_size', ctx=Store())], value=Name(id='hidden_size', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='lstm_layers', ctx=Store())], value=Name(id='lstm__layers', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='attention_head_size', ctx=Store())], value=Name(id='attention_head_size', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='dropout', ctx=Store())], value=Name(id='dropout', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='hidden_continuous_size', ctx=Store())], value=Name(id='hidden_continuous_size', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='loss', ctx=Store())], value=Name(id='loss', ctx=Load())), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='trainer_kwargs', ctx=Store())], value=IfExp(test=Compare(left=Name(id='trainer_kwargs', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=Name(id='trainer_kwargs', ctx=Load()), orelse=Call(func=Name(id='dict', ctx=Load()), args=[], keywords=[]))), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='quantiles_kwargs', ctx=Store())], value=IfExp(test=Compare(left=Name(id='quantiles_kwargs', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), body=Name(id='quantiles_kwargs', ctx=Load()), orelse=Call(func=Name(id='dict', ctx=Load()), args=[], keywords=[]))), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Store()), annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Subscript(value=Name(id='Union', ctx=Load()), slice=Tuple(elts=[Name(id='LightningModule', ctx=Load()), Name(id='TemporalFusionTransformer', ctx=Load())], ctx=Load()), ctx=Load()), ctx=Load()), value=Constant(value=None), simple=0), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load()), attr='trainer', ctx=Store()), annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Attribute(value=Name(id='pl', ctx=Load()), attr='Trainer', ctx=Load()), ctx=Load()), value=Constant(value=None), simple=0), Assign(targets=[Attribute(value=Name(id='self', ctx=Load()), attr='_last_train_timestamp', ctx=Store())], value=Constant(value=None)), AnnAssign(target=Attribute(value=Name(id='self', ctx=Load()), attr='_freq', ctx=Store()), annotation=Subscript(value=Name(id='Optional', ctx=Load()), slice=Name(id='str', ctx=Load()), ctx=Load()), value=Constant(value=None), simple=0)], decorator_list=[]), FunctionDef(name='_GET_PF_TRANSFORM', args=arguments(posonlyargs=[], args=[arg(arg='ts', annotation=Name(id='TSDataset', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[If(test=BoolOp(op=And(), values=[Compare(left=Attribute(value=Name(id='ts', ctx=Load()), attr='transforms', ctx=Load()), ops=[IsNot()], comparators=[Constant(value=None)]), Call(func=Name(id='isinstance', ctx=Load()), args=[Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='transforms', ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load()), Name(id='PytorchForecastingTransform', ctx=Load())], keywords=[])]), body=[Return(value=Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='transforms', ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load()))], orelse=[Raise(exc=Call(func=Name(id='ValueError', ctx=Load()), args=[Constant(value='Not valid usage of transforms, please add PytorchForecastingTransform at the end of transforms')], keywords=[]))])], decorator_list=[Name(id='staticmethodBEI', ctx=Load())], returns=Name(id='PytorchForecastingTransform', ctx=Load())), FunctionDef(name='forecast', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='ts', annotation=Name(id='TSDataset', ctx=Load())), arg(arg='prediction_i_nterval', annotation=Name(id='bool', ctx=Load())), arg(arg='quantiles', annotation=Subscript(value=Name(id='Sequence', ctx=Load()), slice=Name(id='float', ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False), Tuple(elts=[Constant(value=0.025), Constant(value=0.975)], ctx=Load())]), body=[If(test=Compare(left=Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='index', ctx=Load()), slice=Constant(value=0), ctx=Load()), ops=[LtE()], comparators=[Attribute(value=Name(id='self', ctx=Load()), attr='_last_train_timestamp', ctx=Load())]), body=[Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[Constant(value="It is not possible to make in-sample predictions with TFT model! In-sample predictions aren't supported by current implementation.")], keywords=[]))], orelse=[If(test=Compare(left=Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='index', ctx=Load()), slice=Constant(value=0), ctx=Load()), ops=[NotEq()], comparators=[Subscript(value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='date_range', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='_last_train_timestamp', ctx=Load())], keywords=[keyword(arg='periods', value=Constant(value=2)), keyword(arg='freq', value=Attribute(value=Name(id='self', ctx=Load()), attr='_freq', ctx=Load()))]), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())]), body=[Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[JoinedStr(values=[Constant(value='You can only forecast from the next point after the last one in the training dataset: last train timestamp: '), FormattedValue(value=Attribute(value=Name(id='self', ctx=Load()), attr='_last_train_timestamp', ctx=Load()), conversion=-1), Constant(value=', first test timestamp is '), FormattedValue(value=Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='index', ctx=Load()), slice=Constant(value=0), ctx=Load()), conversion=-1)])], keywords=[]))], orelse=[Pass()])]), Assign(targets=[Name(id='pf_transform', ctx=Store())], value=Call(func=Attribute(value=Name(id='self', ctx=Load()), attr='_get_pf_transform', ctx=Load()), args=[Name(id='ts', ctx=Load())], keywords=[])), If(test=Compare(left=Attribute(value=Name(id='pf_transform', ctx=Load()), attr='pf_dataset_predict', ctx=Load()), ops=[Is()], comparators=[Constant(value=None)]), body=[Raise(exc=Call(func=Name(id='ValueError', ctx=Load()), args=[Constant(value='The future is not generated! Generate future using TSDataset make_future before calling forecast method!')], keywords=[]))], orelse=[]), Assign(targets=[Name(id='prediction_dataloader', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pf_transform', ctx=Load()), attr='pf_dataset_predict', ctx=Load()), attr='to_dataloader', ctx=Load()), args=[], keywords=[keyword(arg='train', value=Constant(value=False)), keyword(arg='batch_size', value=BinOp(left=Attribute(value=Name(id='self', ctx=Load()), attr='batch_size', ctx=Load()), op=Mult(), right=Constant(value=2)))])), Assign(targets=[Name(id='predicts', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Load()), attr='predict', ctx=Load()), args=[Name(id='prediction_dataloader', ctx=Load())], keywords=[]), attr='numpy', ctx=Load()), args=[], keywords=[])), Assign(targets=[Subscript(value=Attribute(value=Name(id='ts', ctx=Load()), attr='loc', ctx=Load()), slice=Tuple(elts=[Slice(), Subscript(value=Attribute(value=Name(id='pd', ctx=Load()), attr='IndexSlice', ctx=Load()), slice=Tuple(elts=[Slice(), Constant(value='target')], ctx=Load()), ctx=Load())], ctx=Load()), ctx=Store())], value=Subscript(value=Attribute(value=Name(id='predicts', ctx=Load()), attr='T', ctx=Load()), slice=Slice(upper=Call(func=Name(id='len', ctx=Load()), args=[Attribute(value=Name(id='ts', ctx=Load()), attr='df', ctx=Load())], keywords=[])), ctx=Load())), If(test=Name(id='prediction_i_nterval', ctx=Load()), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Name(id='isinstance', ctx=Load()), args=[Attribute(value=Name(id='self', ctx=Load()), attr='loss', ctx=Load()), Name(id='QuantileLoss', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='warnings', ctx=Load()), attr='warn', ctx=Load()), args=[Constant(value="Quantiles can't be computed because TFTModel supports this only if QunatileLoss is chosen")], keywords=[]))], orelse=[Assign(targets=[Name(id='quantiles_predicts', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Load()), attr='predict', ctx=Load()), args=[Name(id='prediction_dataloader', ctx=Load())], keywords=[keyword(arg='mode', value=Constant(value='quantiles')), keyword(arg='mode_kwargs', value=Dict(keys=[Constant(value='quantiles'), None], values=[Name(id='quantiles', ctx=Load()), Attribute(value=Name(id='self', ctx=Load()), attr='quantiles_kwargs', ctx=Load())]))]), attr='numpy', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='loss_qua', ctx=Store())], value=Attribute(value=Attribute(value=Name(id='self', ctx=Load()), attr='loss', ctx=Load()), attr='quantiles', ctx=Load())), Assign(targets=[Name(id='computed_quantiles_indices', ctx=Store())], value=List(elts=[], ctx=Load())), Assign(targets=[Name(id='computed_quantiles', ctx=Store())], value=List(elts=[], ctx=Load())), Assign(targets=[Name(id='not_computed_quantiles', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Name(id='quantile', ctx=Store()), iter=Name(id='quantiles', ctx=Load()), body=[If(test=Compare(left=Name(id='quantile', ctx=Load()), ops=[In()], comparators=[Name(id='loss_qua', ctx=Load())]), body=[Expr(value=Call(func=Attribute(value=Name(id='computed_quantiles', ctx=Load()), attr='append', ctx=Load()), args=[Name(id='quantile', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='computed_quantiles_indices', ctx=Load()), attr='append', ctx=Load()), args=[Call(func=Attribute(value=Name(id='loss_qua', ctx=Load()), attr='index', ctx=Load()), args=[Name(id='quantile', ctx=Load())], keywords=[])], keywords=[]))], orelse=[Expr(value=Call(func=Attribute(value=Name(id='not_computed_quantiles', ctx=Load()), attr='append', ctx=Load()), args=[Name(id='quantile', ctx=Load())], keywords=[]))])], orelse=[]), If(test=Name(id='not_computed_quantiles', ctx=Load()), body=[Expr(value=Call(func=Attribute(value=Name(id='warnings', ctx=Load()), attr='warn', ctx=Load()), args=[JoinedStr(values=[Constant(value='Quantiles: '), FormattedValue(value=Name(id='not_computed_quantiles', ctx=Load()), conversion=-1), Constant(value=" can't be computed because loss wasn't fitted on them")])], keywords=[]))], orelse=[]), Assign(targets=[Name(id='quantiles_predicts', ctx=Store())], value=Subscript(value=Name(id='quantiles_predicts', ctx=Load()), slice=Tuple(elts=[Slice(), Slice(), Name(id='computed_quantiles_indices', ctx=Load())], ctx=Load()), ctx=Load())), Assign(targets=[Name(id='quantiles', ctx=Store())], value=Name(id='computed_quantiles', ctx=Load())), Assign(targets=[Name(id='quantiles_predicts', ctx=Store())], value=Call(func=Attribute(value=Name(id='quantiles_predicts', ctx=Load()), attr='transpose', ctx=Load()), args=[Tuple(elts=[Constant(value=1), Constant(value=0), Constant(value=2)], ctx=Load())], keywords=[])), Assign(targets=[Name(id='quantiles_predicts', ctx=Store())], value=Call(func=Attribute(value=Name(id='quantiles_predicts', ctx=Load()), attr='reshape', ctx=Load()), args=[Subscript(value=Attribute(value=Name(id='quantiles_predicts', ctx=Load()), attr='shape', ctx=Load()), slice=Constant(value=0), ctx=Load()), UnaryOp(op=USub(), operand=Constant(value=1))], keywords=[])), Assign(targets=[Name(id='df', ctx=Store())], value=Attribute(value=Name(id='ts', ctx=Load()), attr='df', ctx=Load())), Assign(targets=[Name(id='segments', ctx=Store())], value=Attribute(value=Name(id='ts', ctx=Load()), attr='segments', ctx=Load())), Assign(targets=[Name(id='quantile_columns', ctx=Store())], value=ListComp(elt=JoinedStr(values=[Constant(value='target_'), FormattedValue(value=Name(id='quantile', ctx=Load()), conversion=-1, format_spec=JoinedStr(values=[Constant(value='.4g')]))]), generators=[comprehension(target=Name(id='quantile', ctx=Store()), iter=Name(id='quantiles', ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Name(id='columns', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pd', ctx=Load()), attr='MultiIndex', ctx=Load()), attr='from_product', ctx=Load()), args=[List(elts=[Name(id='segments', ctx=Load()), Name(id='quantile_columns', ctx=Load())], ctx=Load())], keywords=[])), Assign(targets=[Name(id='quantiles_df', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='DataFrame', ctx=Load()), args=[Subscript(value=Name(id='quantiles_predicts', ctx=Load()), slice=Slice(upper=Call(func=Name(id='len', ctx=Load()), args=[Name(id='df', ctx=Load())], keywords=[])), ctx=Load())], keywords=[keyword(arg='columns', value=Name(id='columns', ctx=Load())), keyword(arg='index', value=Attribute(value=Name(id='df', ctx=Load()), attr='index', ctx=Load()))])), Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Attribute(value=Name(id='pd', ctx=Load()), attr='concat', ctx=Load()), args=[Tuple(elts=[Name(id='df', ctx=Load()), Name(id='quantiles_df', ctx=Load())], ctx=Load())], keywords=[keyword(arg='axis', value=Constant(value=1))])), Assign(targets=[Name(id='df', ctx=Store())], value=Call(func=Attribute(value=Name(id='df', ctx=Load()), attr='sort_index', ctx=Load()), args=[], keywords=[keyword(arg='axis', value=Constant(value=1))])), Assign(targets=[Attribute(value=Name(id='ts', ctx=Load()), attr='df', ctx=Store())], value=Name(id='df', ctx=Load()))])], orelse=[]), Expr(value=Call(func=Attribute(value=Name(id='ts', ctx=Load()), attr='inverse_transform', ctx=Load()), args=[], keywords=[])), Return(value=Name(id='ts', ctx=Load()))], decorator_list=[Name(id='log_decorator', ctx=Load())], returns=Name(id='TSDataset', ctx=Load())), FunctionDef(name='predict', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='ts', annotation=Name(id='TSDataset', ctx=Load())), arg(arg='prediction_i_nterval', annotation=Name(id='bool', ctx=Load())), arg(arg='quantiles', annotation=Subscript(value=Name(id='Sequence', ctx=Load()), slice=Name(id='float', ctx=Load()), ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=False), Tuple(elts=[Constant(value=0.025), Constant(value=0.975)], ctx=Load())]), body=[Expr(value=Constant(value='\x88Makʭe predictiϬäoȄns.\n\nThis method wƍiĴlʴl make pred̓«iΰctionsͰ usi©ng t1ruɨeϳ valuͲes ƣinʸ̊stead Ѐoͺf predλictϰed on a ģprevious step.\nIt can ͫLbe usefuψl for ˂making in-ƙsampˀle forecasts.\n\nParameteȹrs\n----ɦ-----ɤ-\nts:\n ˛   DatŖaset\u0382Ĳ wͫiȧtǽϱh featuresˇ\nprÙeǘͬdƬicǳtion_intervalϑ:\n    Iǋ̳f True retuͩ´rns prķedictioώnŝ intervaά˰Ϲl for forecVast\nŻqua«Kntiϳles:\n   ̙ LeȭÜv1elΕs Iof ÌprediǺ˳cti\u0381ȸonǥ distributHionÜȾɼ. Byϩ defaƤultǯ 2.5% and ̈97.5ʸ˃Ǖ±% are taʹkVÍen to foȖrmΊ ¦a 95% predƭiοɺction inͣĭterÂ͝vĦal\n\nĲRetuȆrns\n-φ-œ---ʱʓȡ--\nTSDɸ̪atasϦŉet\n    ƎĻTʹSDatasĤeǟt wƲïth predicίti\x9cons.Ⱦ͈')), Raise(exc=Call(func=Name(id='NotImplementedError', ctx=Load()), args=[Constant(value="Method predict isn't currently implemented!")], keywords=[]))], decorator_list=[Name(id='log_decorator', ctx=Load())], returns=Name(id='TSDataset', ctx=Load())), FunctionDef(name='_from_dataset', args=arguments(posonlyargs=[], args=[arg(arg='self'), arg(arg='ts_dataset', annotation=Name(id='TimeSeriesDataSet', ctx=Load()))], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='½Constrąuϕ͘ct ͐Tempυ·orȁalØʏFusSiŰĘʰoĪĠnȓTƽransfϏox̮ržϝ͢Bʇmer.\n\nR\x9be.tsurnŹǞǩs̛\n-Ġ--͑ª-ʨ--̤ʹ-\nL\x8cighĖ˟tniΛǷngModule\u03a2 Þclass Ǽ̟˿Ĭ¿Ǵinį΄ɠstance.')), Return(value=Call(func=Attribute(value=Name(id='TemporalFusionTransformer', ctx=Load()), attr='from_dataset', ctx=Load()), args=[Name(id='ts_dataset', ctx=Load())], keywords=[keyword(arg='learning_rate', value=Attribute(value=Name(id='self', ctx=Load()), attr='learning_rate', ctx=Load())), keyword(arg='hidden_size', value=Attribute(value=Name(id='self', ctx=Load()), attr='hidden_size', ctx=Load())), keyword(arg='lstm_layers', value=Attribute(value=Name(id='self', ctx=Load()), attr='lstm_layers', ctx=Load())), keyword(arg='attention_head_size', value=Attribute(value=Name(id='self', ctx=Load()), attr='attention_head_size', ctx=Load())), keyword(arg='dropout', value=Attribute(value=Name(id='self', ctx=Load()), attr='dropout', ctx=Load())), keyword(arg='hidden_continuous_size', value=Attribute(value=Name(id='self', ctx=Load()), attr='hidden_continuous_size', ctx=Load())), keyword(arg='loss', value=Attribute(value=Name(id='self', ctx=Load()), attr='loss', ctx=Load()))]))], decorator_list=[], returns=Name(id='LightningModule', ctx=Load())), FunctionDef(name='get_model', args=arguments(posonlyargs=[], args=[arg(arg='self')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Expr(value=Constant(value='Get͘ iǺnternal model thǠat is useψhd īnsi=de etn1aʮ class.\n\nInternȡalØ model ūis a model thatȚ is uǐŇsƮed in˛side etna to for̀ecast segments,\neƉɋ.g̓. :py:class:`̓ca̩tboostà.̉CͰ˄atBɧoostRegressorċ`. or :py̨μį:clasſs:ɢš`skôlexaͨrn.lineaνrƆ_model.Riødʍge`͙.\n\nReturn°s\n---Ɛ----ϟ\n:\n   Internal model')), Return(value=Attribute(value=Name(id='self', ctx=Load()), attr='model', ctx=Load()))], decorator_list=[], returns=Name(id='Any', ctx=Load()))], decorator_list=[])], type_ignores=[])